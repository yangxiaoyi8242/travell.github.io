import{_ as Ve,r as M,a as b,k as Ce,c as z,o as c,d as l,w as a,e as u,B as xe,F as $,i as F,g as s,b as B,C as ze,D as k,m as N,G as De,H as Se,h as D,t as S,j as h,I as Te,x as Ue,E as y,J as Q}from"./index-BrrAfP23.js";const Be={class:"document-management-container"},Pe={class:"table-operations"},$e={class:"pagination-container"},Fe={class:"form-designer-placeholder"},he={key:1},Ee={class:"dialog-footer"},Ie={__name:"DocumentManagement",setup(Me){const X=[{value:"all",label:"全部"},{value:"enabled",label:"启用"},{value:"disabled",label:"停用"}],Y=[{value:"all",label:"全部"},{value:"application",label:"申请单"},{value:"reimbursement",label:"报销单"}],i=M({name:"",status:"all",type:"all"}),O=b([]),E=b(!1),R=b([]),p=M({currentPage:1,pageSize:10,total:0}),_=b(!1),r=b(""),T=b(""),j=b(null),n=M({id:"",name:"",type:"application",status:"enabled",content:[],workflow:""}),q={name:[{required:!0,message:"请输入单据名称",trigger:"blur"}],type:[{required:!0,message:"请选择单据类型",trigger:"change"}]},W=b([{value:"flow1-1",label:"一录一审（员工-部门主管）"},{value:"flow1-2",label:"一录两审（员工-部门主管-部门总经理）"},{value:"flow1-3",label:"一录三审（员工-项目经理-部门主管-部门总经理）"},{value:"flow1-4",label:"一录四审（员工-项目经理-部门主管-部门总经理-行政人员）"},{value:"flow2-1",label:"一录一审（员工-财务人员）"},{value:"flow2-2",label:"一录两审（员工-部门主管-财务人员）"},{value:"flow2-3",label:"一录三审（员工-部门主管-部门总经理-财务人员）"},{value:"flow2-4",label:"一录四审（员工-项目经理-部门主管-部门总经理-财务人员）"}]),G=b([{value:"travel-application",label:"出差申请单",type:"application"},{value:"travel-reimbursement",label:"出差报销单",type:"reimbursement"},{value:"loan-application",label:"借款单",type:"application"},{value:"entertainment-reimbursement",label:"招待费报销单",type:"reimbursement"},{value:"expense-reimbursement",label:"费用报销单",type:"reimbursement"},{value:"contract-payment",label:"合同付款单",type:"application"}]),x=b(null),I=b(null);Ce(()=>{g()});const g=()=>{E.value=!0,setTimeout(()=>{let e=[...[{id:"1",name:"出差申请单",type:"application",status:"enabled",createTime:"2023-05-15 10:30:00",workflow:"flow1-2",content:[]},{id:"2",name:"出差报销单",type:"reimbursement",status:"enabled",createTime:"2023-05-15 11:20:00",workflow:"flow2-3",content:[]},{id:"3",name:"招待费报销单",type:"reimbursement",status:"disabled",createTime:"2023-05-16 09:15:00",workflow:"flow2-2",content:[]}]];i.name&&(e=e.filter(m=>m.name.includes(i.name))),i.status!=="all"&&(e=e.filter(m=>m.status===i.status)),i.type!=="all"&&(e=e.filter(m=>m.type===i.type)),p.total=e.length;const v=(p.currentPage-1)*p.pageSize,d=v+p.pageSize;O.value=e.slice(v,d),E.value=!1},500)},H=()=>{p.currentPage=1,g()},Z=()=>{i.name="",i.status="all",i.type="all",H()},ee=o=>{R.value=o},le=o=>{p.currentPage=o,g()},te=o=>{p.pageSize=o,p.currentPage=1,g()},ae=()=>{r.value="new",T.value="新增单据",J(),_.value=!0},ne=()=>{r.value="import",T.value="导入模板",J(),_.value=!0},oe=o=>{r.value="edit",T.value="编辑单据",j.value=o,Object.keys(n).forEach(e=>{e in o&&(n[e]=o[e])}),_.value=!0},ue=o=>{r.value="workflow",T.value="关联审批流程",j.value=o,n.workflow=o.workflow,_.value=!0},J=()=>{n.id="",n.name="",n.type="application",n.status="enabled",n.content=[],n.workflow="",x.value&&x.value.resetFields()},se=async()=>{x.value&&await x.value.validate(o=>{o&&(r.value==="new"||r.value==="edit"?(y.success(r.value==="new"?"新增单据成功":"编辑单据成功"),_.value=!1,g()):r.value==="import"&&(y.success("导入模板成功"),_.value=!1,g()))})},ie=async()=>{I.value&&await I.value.validate(o=>{o&&(y.success("关联审批流程成功"),_.value=!1,g())})},de=()=>{if(R.value.length===0){y.warning("请至少选择一条记录");return}Q.confirm("确认删除选中的单据吗？删除后将无法恢复","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{y.success("删除成功"),g()}).catch(()=>{})},re=o=>{const e=o.status==="enabled"?"disabled":"enabled",v=e==="enabled"?"启用":"停用";Q.confirm(`确认${v}该单据吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{o.status=e,y.success(`${v}成功`),g()}).catch(()=>{})},pe=o=>{y.info("跳转到智能凭证中心功能")},me=o=>{const e=G.value.find(v=>v.value===o);e&&(n.name=e.label,n.type=e.type,y.success(`已选择${e.label}模板`))};return(o,e)=>{const v=u("el-input"),d=u("el-form-item"),m=u("el-option"),U=u("el-select"),f=u("el-button"),P=u("el-form"),L=u("el-card"),w=u("el-icon"),V=u("el-table-column"),A=u("el-tag"),fe=u("el-table"),ce=u("el-pagination"),K=u("el-switch"),ve=u("el-empty"),be=u("el-radio-button"),_e=u("el-space"),ge=u("el-radio-group"),ye=u("el-dialog"),we=xe("loading");return c(),z("div",Be,[l(L,{class:"search-card"},{default:a(()=>[l(P,{model:i,inline:""},{default:a(()=>[l(d,{label:"单据名称"},{default:a(()=>[l(v,{modelValue:i.name,"onUpdate:modelValue":e[0]||(e[0]=t=>i.name=t),placeholder:"请输入单据名称",clearable:""},null,8,["modelValue"])]),_:1}),l(d,{label:"单据状态"},{default:a(()=>[l(U,{modelValue:i.status,"onUpdate:modelValue":e[1]||(e[1]=t=>i.status=t),placeholder:"请选择单据状态"},{default:a(()=>[(c(),z($,null,F(X,t=>l(m,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"单据类型"},{default:a(()=>[l(U,{modelValue:i.type,"onUpdate:modelValue":e[2]||(e[2]=t=>i.type=t),placeholder:"请选择单据类型"},{default:a(()=>[(c(),z($,null,F(Y,t=>l(m,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(d,null,{default:a(()=>[l(f,{type:"primary",onClick:H},{default:a(()=>e[17]||(e[17]=[s("查询")])),_:1}),l(f,{onClick:Z},{default:a(()=>e[18]||(e[18]=[s("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(L,{class:"table-card"},{default:a(()=>[B("div",Pe,[B("div",null,[l(f,{type:"primary",onClick:ae},{default:a(()=>[l(w,null,{default:a(()=>[l(k(N))]),_:1}),e[19]||(e[19]=s("新增 "))]),_:1}),l(f,{type:"success",onClick:ne},{default:a(()=>[l(w,null,{default:a(()=>[l(k(De))]),_:1}),e[20]||(e[20]=s("导入模板 "))]),_:1}),l(f,{type:"danger",onClick:de},{default:a(()=>[l(w,null,{default:a(()=>[l(k(Se))]),_:1}),e[21]||(e[21]=s("批量删除 "))]),_:1})])]),ze((c(),D(fe,{data:O.value,border:"",style:{width:"100%"},onSelectionChange:ee},{default:a(()=>[l(V,{type:"selection",width:"55"}),l(V,{prop:"name",label:"单据名称","min-width":"150"}),l(V,{prop:"type",label:"单据类型",width:"120"},{default:a(({row:t})=>[l(A,{type:t.type==="application"?"primary":"success"},{default:a(()=>[s(S(t.type==="application"?"申请单":"报销单"),1)]),_:2},1032,["type"])]),_:1}),l(V,{prop:"status",label:"单据状态",width:"100"},{default:a(({row:t})=>[l(A,{type:t.status==="enabled"?"success":"info"},{default:a(()=>[s(S(t.status==="enabled"?"启用":"停用"),1)]),_:2},1032,["type"])]),_:1}),l(V,{prop:"createTime",label:"创建时间",width:"180"}),l(V,{prop:"workflow",label:"关联流程","min-width":"180"},{default:a(({row:t})=>{var C;return[s(S(((C=W.value.find(ke=>ke.value===t.workflow))==null?void 0:C.label)||"未关联"),1)]}),_:1}),l(V,{label:"操作",width:"280",fixed:"right"},{default:a(({row:t})=>[l(f,{size:"small",type:"primary",onClick:C=>oe(t)},{default:a(()=>[l(w,null,{default:a(()=>[l(k(Te))]),_:1}),e[22]||(e[22]=s("修改 "))]),_:2},1032,["onClick"]),l(f,{size:"small",type:t.status==="enabled"?"warning":"success",onClick:C=>re(t)},{default:a(()=>[l(w,null,{default:a(()=>[s(S(t.status==="enabled"?"<VideoPause />":"<VideoPlay />"),1)]),_:2},1024),s(" "+S(t.status==="enabled"?"停用":"启用"),1)]),_:2},1032,["type","onClick"]),l(f,{size:"small",type:"info",onClick:C=>ue(t)},{default:a(()=>[l(w,null,{default:a(()=>[l(k(Ue))]),_:1}),e[23]||(e[23]=s("关联流程 "))]),_:2},1032,["onClick"]),t.type==="reimbursement"?(c(),D(f,{key:0,size:"small",type:"success",onClick:C=>pe(t)},{default:a(()=>[l(w,null,{default:a(()=>[l(k(N))]),_:1}),e[24]||(e[24]=s("生成凭证模板 "))]),_:2},1032,["onClick"])):h("",!0)]),_:1})]),_:1},8,["data"])),[[we,E.value]]),B("div",$e,[l(ce,{"current-page":p.currentPage,"onUpdate:currentPage":e[3]||(e[3]=t=>p.currentPage=t),"page-size":p.pageSize,"onUpdate:pageSize":e[4]||(e[4]=t=>p.pageSize=t),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:p.total,onSizeChange:te,onCurrentChange:le},null,8,["current-page","page-size","total"])])]),_:1}),l(ye,{modelValue:_.value,"onUpdate:modelValue":e[16]||(e[16]=t=>_.value=t),title:T.value,width:"50%","destroy-on-close":""},{footer:a(()=>[B("span",Ee,[l(f,{onClick:e[14]||(e[14]=t=>_.value=!1)},{default:a(()=>e[26]||(e[26]=[s("取消")])),_:1}),l(f,{type:"primary",onClick:e[15]||(e[15]=t=>r.value==="workflow"?ie():se())},{default:a(()=>e[27]||(e[27]=[s(" 确定 ")])),_:1})])]),default:a(()=>[r.value==="new"||r.value==="edit"?(c(),D(P,{key:0,ref_key:"formRef",ref:x,model:n,rules:q,"label-width":"100px"},{default:a(()=>[l(d,{label:"单据名称",prop:"name"},{default:a(()=>[l(v,{modelValue:n.name,"onUpdate:modelValue":e[5]||(e[5]=t=>n.name=t),placeholder:"请输入单据名称"},null,8,["modelValue"])]),_:1}),l(d,{label:"单据类型",prop:"type"},{default:a(()=>[l(U,{modelValue:n.type,"onUpdate:modelValue":e[6]||(e[6]=t=>n.type=t),placeholder:"请选择单据类型",disabled:r.value==="edit"},{default:a(()=>[l(m,{label:"申请单",value:"application"}),l(m,{label:"报销单",value:"reimbursement"})]),_:1},8,["modelValue","disabled"])]),_:1}),l(d,{label:"单据状态"},{default:a(()=>[l(K,{modelValue:n.status,"onUpdate:modelValue":e[7]||(e[7]=t=>n.status=t),"active-value":"enabled","inactive-value":"disabled","active-text":"启用","inactive-text":"停用"},null,8,["modelValue"])]),_:1}),l(d,{label:"单据内容"},{default:a(()=>[B("div",Fe,[l(ve,{description:"单据设计器功能将在后期实现"},{image:a(()=>[l(w,{size:60},{default:a(()=>[l(k(N))]),_:1})]),_:1})])]),_:1})]),_:1},8,["model"])):h("",!0),r.value==="import"?(c(),z("div",he,[l(P,{ref_key:"formRef",ref:x,model:n,rules:q,"label-width":"100px"},{default:a(()=>[l(d,{label:"选择模板",required:""},{default:a(()=>[l(ge,{modelValue:n.templateId,"onUpdate:modelValue":e[8]||(e[8]=t=>n.templateId=t)},{default:a(()=>[l(_e,{wrap:""},{default:a(()=>[(c(!0),z($,null,F(G.value,t=>(c(),D(be,{key:t.value,label:t.value,onChange:C=>me(t.value)},{default:a(()=>[s(S(t.label),1)]),_:2},1032,["label","onChange"]))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"单据名称",prop:"name"},{default:a(()=>[l(v,{modelValue:n.name,"onUpdate:modelValue":e[9]||(e[9]=t=>n.name=t),placeholder:"请输入单据名称"},null,8,["modelValue"])]),_:1}),l(d,{label:"单据类型",prop:"type"},{default:a(()=>[l(U,{modelValue:n.type,"onUpdate:modelValue":e[10]||(e[10]=t=>n.type=t),placeholder:"请选择单据类型",disabled:""},{default:a(()=>[l(m,{label:"申请单",value:"application"}),l(m,{label:"报销单",value:"reimbursement"})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"单据状态"},{default:a(()=>[l(K,{modelValue:n.status,"onUpdate:modelValue":e[11]||(e[11]=t=>n.status=t),"active-value":"enabled","inactive-value":"disabled","active-text":"启用","inactive-text":"停用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])):h("",!0),r.value==="workflow"?(c(),D(P,{key:2,ref_key:"workflowFormRef",ref:I,model:n,"label-width":"100px"},{default:a(()=>[l(d,{label:"审批流程",prop:"workflow"},{default:a(()=>[l(U,{modelValue:n.workflow,"onUpdate:modelValue":e[12]||(e[12]=t=>n.workflow=t),placeholder:"请选择审批流程"},{default:a(()=>[(c(!0),z($,null,F(W.value,t=>(c(),D(m,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,null,{default:a(()=>[l(f,{type:"primary",onClick:e[13]||(e[13]=()=>{k(y).info("跳转到流程管理功能")})},{default:a(()=>e[25]||(e[25]=[s(" 新增审批流程 ")])),_:1})]),_:1})]),_:1},8,["model"])):h("",!0)]),_:1},8,["modelValue","title"])])}}},Oe=Ve(Ie,[["__scopeId","data-v-f25c7f85"]]);export{Oe as default};
